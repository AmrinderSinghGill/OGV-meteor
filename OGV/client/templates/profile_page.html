<template name="profilePage">
    <div id="profileContainer">
        <a href="/profile/{{ currentUser._id }}">
            <div class="post-item user-image" style="background-image:url(&quot;{{userImg}}&quot;); width:200px; height:200px;left:70px;position:relative;"></div>
        </a>
        <div id="profileInfo">
            <h2>{{ person.profile.name }}</h2>
            <strong>FOLLOWERS {{followerCount}}</strong>
            &nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp;&nbsp;&nbsp;
            <strong>FOLLOWING {{followingCount}}</strong><br>
            <button id = "followButton" >+FOLLOW</button><br>
            <button id = "unfollowButton" style="display: none;">UNFOLLOW</button>

            <h3>{{ person.profile.bio }} </h3>
            <strong>Here Since:</strong> <em>{{ person.createdAt }}</em> <br>
        </div>
    </div>

    <div id="profileModelFeedContainer">
        <hr>
        {{> profileModelFeed}}
    </div>
    
    <!-- Handling button visibility -->
    <script>
        //take out id from url
        var parts = location.href.split('/');
		var id = parts.pop();

        //user currently logged in
		var currentUser = Meteor.user();

        var checkForUser = Meteor.users.findOne({_id: currentUser._id}, {"profile.following": id });

        if( typeof checkForUser == 'undefined' ){
            document.getElementById("followButton").style.display="block";
            document.getElementById("unfollowButton").style.display="none";
        } else {
            document.getElementById("followButton").style.display="none";
            if ( currentUser._id == id ) {
                document.getElementById("unfollowButton").style.display="none";
            } else {
                document.getElementById("unfollowButton").style.display="block";
            }        
            
        }

    </script>
</template>


<template name="profileModelFeed">
    <div class="profile-feed-wrapper">
    {{#if models}}
    {{#each models}}
        {{#if converted }}
        {{> modelPost }}
        {{/if}}
    {{/each}}
    {{else}}
    <h3>{{user.profile.name}} has no uploaded models</h3>
    {{/if}}
    </div>
</template>
